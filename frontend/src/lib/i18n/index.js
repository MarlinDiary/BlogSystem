import { writable, derived } from 'svelte/store';

// Create language store
export const locale = writable(
  typeof window !== 'undefined' 
    ? localStorage.getItem('locale') || 'en'
    : 'en'
);

// Listen for language changes and save to localStorage
locale.subscribe(value => {
  if (typeof window !== 'undefined') {
    localStorage.setItem('locale', value);
    document.documentElement.lang = value;
  }
});

// Translation dictionary
const translations = {
  zh: {
    // 导航
    'nav.home': '首页',
    'nav.articles': '文章',
    'nav.about': '关于',
    'nav.community': '社区',
    'nav.publish': '发布',
    'nav.search': '搜索',
    'nav.goto': '前往',
    
    // 通用
    'common.siteLogo': '网站Logo',
    'common.login': '登录',
    'common.register': '注册',
    'common.logout': '退出登录',
    'common.profile': '个人资料',
    'common.articles': '文章',
    'common.security': '安全设置',
    'common.danger': '危险区域',
    'common.save': '保存',
    'common.cancel': '取消',
    'common.delete': '删除',
    'common.edit': '编辑',
    'common.loading': '加载中...',
    'common.processing': '处理中...',
    'common.confirm': '确认',
    'common.submit': '提交',
    'common.search': '搜索',
    'common.more': '更多',
    'common.back': '返回',
    'common.next': '下一步',
    'common.previous': '上一步',
    'common.close': '关闭',
    'common.upload': '上传',
    'common.change': '更改',
    'common.remove': '移除',
    'common.add': '添加',
    'common.create': '创建',
    'common.update': '更新',
    'common.preview': '预览',
    'common.noData': '暂无数据',
    'common.loadMore': '加载更多',
    'common.showAll': '显示全部',
    'common.hideAll': '隐藏全部',
    'common.showPassword': '显示密码',
    'common.hidePassword': '隐藏密码',
    'common.siteNavigation': '站内导航',
    'common.dateFormat': '{year}年{month}月{day}日',
    
    // 验证消息
    'validation.required': '此字段为必填项',
    'validation.titleRequired': '请输入文章标题',
    'validation.contentRequired': '请输入文章内容',
    'validation.coverRequired': '请上传封面图片',
    'validation.tagsRequired': '请生成文章标签',
    'validation.invalidFormat': '格式无效',
    'validation.usernameExists': '用户名已被使用',
    'validation.usernameAvailable': '用户名可用',
    'validation.passwordMinLength': '至少8个字符',
    'validation.passwordRequireLetter': '包含字母',
    'validation.passwordRequireNumber': '包含数字',
    'validation.passwordRequired': '请输入密码',
    'validation.passwordMismatch': '两次输入的密码不一致',
    'validation.invalidEmail': '邮箱格式无效',
    'validation.invalidDate': '日期格式无效',
    'validation.usernameLength': '6-20个字符',
    'validation.usernameFormat': '仅支持字母、数字和下划线',
    'validation.realNameMinLength': '至少2个字符',
    'validation.dateFormat': '格式：YYYY-MM-DD',
    
    // 文章相关
    'article.title': '标题',
    'article.createNew': '发布文章',
    'article.createDescription': '分享你的想法，记录你的创作',
    'article.titlePlaceholder': '输入一个吸引人的标题...',
    'article.content': '内容',
    'article.contentPlaceholder': '在这里写下你的想法...',
    'article.cover': '封面图片',
    'article.uploadCover': '上传封面图片',
    'article.changeCover': '更换封面',
    'article.dragImageTip': '点击或拖拽图片至此处',
    'article.tags': '标签',
    'article.generateTags': '点击生成标签',
    'article.generateTagsTip': 'AI 将根据文章标题生成合适的标签',
    'article.removeTag': '删除标签 {tag}',
    'article.publish': '发布文章',
    'article.draft': '草稿',
    'article.preview': '预览',
    'article.views': '阅读',
    'article.comments': '评论',
    'article.writeComment': '写评论',
    'article.loginToComment': '请登录后发表评论',
    'article.noComments': '暂无评论',
    'article.readyToPublish': '文章已准备就绪',
    'article.explore': '探索文章',
    'article.jumpToSection': '跳转到{section}章节',
    'article.update': '更新文章',
    'article.noChanges': '暂无修改',
    'article.tableOfContents': '文章目录',
    'article.sortByTime': '按时间排序',
    'article.sortByViews': '按阅读量排序',
    'article.sortByComments': '按评论数排序',
    'article.sortByReactions': '按反应数排序',
    'article.editTitle': '编辑文章 - {title}',
    'article.newArticle': '新建文章',
    'article.noMore': '没有更多文章了',
    
    // 用户相关
    'user.username': '用户名',
    'user.password': '密码',
    'user.email': '邮箱',
    'user.bio': '个人简介',
    'user.avatar': '头像',
    'user.changePassword': '修改密码',
    'user.currentPassword': '当前密码',
    'user.newPassword': '新密码',
    'user.confirmPassword': '确认密码',
    'user.deleteAccount': '删除账号',
    'user.confirmDeleteAccount': '确认删除账号？此操作不可恢复',
    
    // 错误消息
    'error.general': '发生错误',
    'error.network': '网络错误',
    'error.unauthorized': '未授权访问',
    'error.notFound': '未找到',
    'error.invalidCredentials': '用户名或密码错误',
    'error.serverError': '服务器错误',
    'error.timeout': '请求超时',
    'error.noApiKey': 'OpenAI API Key未配置，请联系管理员',
    'error.uploadFailed': '上传失败',
    'error.generateTagsFailed': '生成标签失败',
    'error.generateArticleFailed': '生成文章失败',
    'error.publishFailed': '发布失败',
    'error.loadArticlesFailed': '加载文章失败: {status} {statusText}',
    'error.loadArticlesRetry': '加载文章失败，请稍后重试',
    'error.fetchArticlesFailed': '获取文章列表失败',
    'error.invalidContentType': '预期接收 JSON 数据，但收到 {type}',
    'error.fetchArticleDetailFailed': '获取文章详情失败',
    'error.updateFailed': '更新失败，请稍后重试',
    'error.accountBanned': '账号已被封禁',
    
    // 成功消息
    'success.saved': '保存成功',
    'success.deleted': '删除成功',
    'success.updated': '更新成功',
    'success.created': '创建成功',
    'success.passwordChanged': '密码修改成功',
    
    // 提示消息
    'tips.dragImage': '拖拽图片到此处或点击上传',
    'tips.selectTags': '选择或创建标签',
    'tips.writeContent': '在这里写下你的想法...',
    'tips.preview': '预览模式',
    
    // 编辑器相关
    'editor.h1': '标题 1',
    'editor.h2': '标题 2',
    'editor.h3': '标题 3',
    'editor.bold': '加粗',
    'editor.italic': '斜体',
    'editor.underline': '下划线',
    'editor.image': '插入图片',
    'editor.bulletList': '无序列表',
    'editor.orderedList': '有序列表',
    'editor.codeBlock': '代码块',
    'editor.blockquote': '引用',
    'editor.aiWriting': 'AI智能写作',
    'editor.aiWritingTip': 'AI将根据标题生成文章内容',
    'editor.generating': '正在生成...',
    'editor.placeholder': '在这里开始写作...',
    
    // 日志消息
    'log.uploadingImage': '正在上传内容图片',
    'log.uploadImageSuccess': '上传内容图片成功',
    'log.uploadImageError': '上传图片失败',
    'log.uploadingCover': '正在上传封面',
    'log.uploadCoverSuccess': '上传封面成功',
    'log.uploadCoverError': '上传封面失败',
    'log.generateTagsError': '生成标签失败',
    'log.generateArticleError': '生成文章失败',
    'log.publishingArticle': '正在发布文章',
    'log.publishError': '发布文章失败',
    'log.checkUsernameError': '检查用户名失败',
    
    // 时间相关
    'time.justNow': '刚刚',
    'time.secondsAgo': '{seconds} 秒前',
    'time.minutesAgo': '{minutes} 分钟前',
    'time.hoursAgo': '{hours} 小时前',
    'time.daysAgo': '{days} 天前',
    
    // 评论相关
    'comment.inputArea': '评论输入区域',
    'comment.loginToComment': '请登录后发表评论',
    'comment.please': '请',
    'comment.toComment': '后发表评论',
    'comment.replyToLogin': '请登录后回复评论',
    'comment.placeholder': '说点什么吧，万一火不了呢...',
    'comment.markdownSupport': '支持',
    'comment.gfmLink': 'GFM',
    'comment.preview': '预览评论',
    'comment.closePreview': '关闭预览',
    'comment.sending': '发送中...',
    'comment.send': '发送评论',
    'comment.noComments': '还没有评论，来说两句吧~',
    'comment.replyTo': '回复 {username} 的评论',
    'comment.writeReply': '写下你的回复...',
    'comment.justNow': '刚刚',
    'comment.hideComment': '隐藏评论',
    'comment.showComment': '显示评论',
    'comment.hideReply': '隐藏回复',
    'comment.showReply': '显示回复',
    'comment.delete': '删除评论',
    'comment.deleteReply': '删除回复',
    'comment.sendFailed': '评论发送失败',
    'comment.replyFailed': '回复发送失败',
    'comment.deleteFailed': '删除评论失败',
    
    // 用户卡片相关
    'userCard.close': '关闭',
    'userCard.noArticles': '暂无文章',
    'userCard.views': '阅读',
    'userCard.userCard': '{name}的个人卡片',
    'userCard.loading': '加载用户数据中...',
    'userCard.loadError': '加载用户数据失败',
    
    // 账户模态框相关
    'account.profile': '个人资料',
    'account.articles': '我的文章',
    'account.comments': '我的评论',
    'account.security': '安全设置',
    'account.danger': '危险区域',
    'account.back': '返回',
    'account.unknownUser': '未知用户',
    'account.realName': '真实姓名',
    'account.save': '保存修改',
    'account.defaultAvatar': '用户头像',
    'account.uploadAvatar': '上传新头像',
    'account.changeAvatar': '更换头像',
    'account.uploadFailed': '上传失败',
    'account.updateSuccess': '更新成功',
    'account.updateFailed': '更新失败',
    'account.username': '用户名',
    'account.dateOfBirth': '出生日期',
    'account.bio': '个人简介',
    'account.bioPlaceholder': '写点什么来介绍一下自己吧...',
    'account.online': '在线',
    'account.offline': '离线',
    'account.lastSeen': '最后在线',
    'account.joinedDate': '加入时间',
    'account.editField': '编辑{field}',
    'account.deleteAccount': '删除账号',
    'account.deleteConfirm': '确认删除账号？此操作不可恢复',
    'account.passwordRequired': '请输入密码确认',
    'account.deleteSuccess': '账号已删除',
    'account.deleteFailed': '删除账号失败',
    'account.logout': '退出登录',
    'account.closeDialog': '关闭对话框',
    'account.currentPassword': '当前密码',
    'account.newPassword': '新密码',
    'account.confirmPassword': '确认新密码',
    'account.changePassword': '修改密码',
    'account.changing': '修改中...',
    'account.noArticles': '还没有发布过文章',
    'account.writeArticle': '写一篇文章',
    'account.readCount': '阅读 {count}',
    'account.commentCount': '评论 {count}',
    'account.editArticle': '编辑文章',
    'account.deleteArticle': '删除文章',
    'account.confirmDelete': '确认删除',
    'account.cancelDelete': '取消删除',
    'account.noComments': '还没有发表过评论',
    'account.commentOn': '评论于：{title}',
    'account.hideComment': '隐藏评论',
    'account.showComment': '显示评论',
    'account.deleteComment': '删除评论',
    'account.dangerZoneDesc': '删除账号后，您的所有数据将被永久删除且无法恢复。请谨慎操作。',
    'account.deleteArticlesConfirm': '同时删除我的所有文章',
    'account.deleteCommentsConfirm': '同时删除我的所有评论',
    'account.deleting': '删除中...',
    'account.noAccount': '还没有账号？',
    'account.hasAccount': '已经有账号了？',
    'account.avatar': '头像',
    'account.avatarTip': '推荐使用正方形图片，支持 PNG、JPG 格式，大小不超过 2 MB',
    'account.password': '密码',
    'account.enterPassword': '请输入密码以确认',
    'account.deleteAllWarning': '警告：删除账号将永久删除您的所有文章和评论',
    
    // 好友卡片相关
    'friendCard.articles': '文章',
    'friendCard.comments': '评论',
    'friendCard.userCard': '{name}的个人卡片',
    'friendCard.extractColorError': '提取头像颜色失败',
    
    // 搜索相关
    'search.placeholder': '搜索文章...',
    'search.noResults': '未找到相关文章',
    'search.loading': '搜索中...',
    'search.error': '搜索出错',
    'search.enterKeyword': '输入关键词开始搜索',
    'community.title': '社区成员',
    'community.description': '认识有趣的人，发现精彩的故事',
    'community.noMembers': '暂无成员',
    
    // 账户设置相关
    'account.settings': '设置',
    'account.generalSettings': '通用设置',
    'account.language': '语言设置',
    'account.currentLanguage': '当前语言',
    'account.switchLanguage': '切换语言',
  },
  en: {
    // Navigation
    'nav.home': 'Home',
    'nav.articles': 'Articles',
    'nav.about': 'About',
    'nav.community': 'Community',
    'nav.publish': 'Publish',
    'nav.search': 'Search',
    'nav.goto': 'Go to',
    
    // Common
    'common.siteLogo': 'Site Logo',
    'common.login': 'Login',
    'common.register': 'Register',
    'common.logout': 'Logout',
    'common.profile': 'Profile',
    'common.articles': 'Articles',
    'common.security': 'Security',
    'common.danger': 'Danger Zone',
    'common.save': 'Save',
    'common.cancel': 'Cancel',
    'common.delete': 'Delete',
    'common.edit': 'Edit',
    'common.loading': 'Loading...',
    'common.processing': 'Processing...',
    'common.confirm': 'Confirm',
    'common.submit': 'Submit',
    'common.search': 'Search',
    'common.more': 'More',
    'common.back': 'Back',
    'common.next': 'Next',
    'common.previous': 'Previous',
    'common.close': 'Close',
    'common.upload': 'Upload',
    'common.change': 'Change',
    'common.remove': 'Remove',
    'common.add': 'Add',
    'common.create': 'Create',
    'common.update': 'Update',
    'common.preview': 'Preview',
    'common.noData': 'No data',
    'common.loadMore': 'Load more',
    'common.showAll': 'Show all',
    'common.hideAll': 'Hide all',
    'common.showPassword': 'Show password',
    'common.hidePassword': 'Hide password',
    'common.siteNavigation': 'Site Navigation',
    'common.dateFormat': '{month}/{day}/{year}',
    
    // Validation messages
    'validation.required': 'This field is required',
    'validation.titleRequired': 'Please enter article title',
    'validation.contentRequired': 'Please enter article content',
    'validation.coverRequired': 'Please upload cover image',
    'validation.tagsRequired': 'Please generate article tags',
    'validation.invalidFormat': 'Invalid format',
    'validation.usernameExists': 'Username is already taken',
    'validation.usernameAvailable': 'Username is available',
    'validation.passwordMinLength': 'At least 8 characters',
    'validation.passwordRequireLetter': 'Include letters',
    'validation.passwordRequireNumber': 'Include numbers',
    'validation.passwordRequired': 'Please enter password',
    'validation.passwordMismatch': 'Passwords do not match',
    'validation.invalidEmail': 'Invalid email format',
    'validation.invalidDate': 'Invalid date format',
    'validation.usernameLength': '6-20 characters',
    'validation.usernameFormat': 'Letters, numbers, underscore only',
    'validation.realNameMinLength': 'At least 2 characters',
    'validation.dateFormat': 'Format: YYYY-MM-DD',
    
    // Article related
    'article.title': 'Title',
    'article.createNew': 'Create Article',
    'article.createDescription': 'Share your thoughts, record your creations',
    'article.titlePlaceholder': 'Enter an engaging title...',
    'article.content': 'Content',
    'article.contentPlaceholder': 'Write your thoughts here...',
    'article.cover': 'Cover Image',
    'article.uploadCover': 'Upload Cover Image',
    'article.changeCover': 'Change Cover',
    'article.dragImageTip': 'Click or drag image here',
    'article.tags': 'Tags',
    'article.generateTags': 'Click to generate tags',
    'article.generateTagsTip': 'AI will generate suitable tags based on the article title',
    'article.removeTag': 'Remove tag {tag}',
    'article.publish': 'Publish Article',
    'article.draft': 'Draft',
    'article.preview': 'Preview',
    'article.views': 'Views',
    'article.comments': 'Comments',
    'article.writeComment': 'Write a comment',
    'article.loginToComment': 'Please login to comment',
    'article.noComments': 'No comments yet',
    'article.readyToPublish': 'Article is ready to publish',
    'article.explore': 'Explore Articles',
    'article.jumpToSection': 'Jump to section {section}',
    'article.update': 'Update Article',
    'article.noChanges': 'No changes',
    'article.tableOfContents': 'Table of Contents',
    'article.sortByTime': 'Sort by Time',
    'article.sortByViews': 'Sort by Views',
    'article.sortByComments': 'Sort by Comments',
    'article.sortByReactions': 'Sort by Reactions',
    'article.editTitle': 'Edit Article - {title}',
    'article.newArticle': 'New Article',
    'article.noMore': 'No more articles',
    
    // User related
    'user.username': 'Username',
    'user.password': 'Password',
    'user.email': 'Email',
    'user.bio': 'Bio',
    'user.avatar': 'Avatar',
    'user.changePassword': 'Change Password',
    'user.currentPassword': 'Current Password',
    'user.newPassword': 'New Password',
    'user.confirmPassword': 'Confirm Password',
    'user.deleteAccount': 'Delete Account',
    'user.confirmDeleteAccount': 'Are you sure you want to delete your account? This action cannot be undone',
    
    // Error messages
    'error.general': 'An error occurred',
    'error.network': 'Network error',
    'error.unauthorized': 'Unauthorized access',
    'error.notFound': 'Not found',
    'error.invalidCredentials': 'Invalid username or password',
    'error.serverError': 'Server error',
    'error.timeout': 'Request timeout',
    'error.noApiKey': 'OpenAI API Key not configured, please contact administrator',
    'error.uploadFailed': 'Upload failed',
    'error.generateTagsFailed': 'Failed to generate tags',
    'error.generateArticleFailed': 'Failed to generate article',
    'error.publishFailed': 'Failed to publish',
    'error.loadArticlesFailed': 'Failed to load articles: {status} {statusText}',
    'error.loadArticlesRetry': 'Failed to load articles, please try again later',
    'error.fetchArticlesFailed': 'Failed to fetch article list',
    'error.invalidContentType': 'Expected JSON data but received {type}',
    'error.fetchArticleDetailFailed': 'Failed to fetch article detail',
    'error.updateFailed': 'Update failed, please try again later',
    'error.accountBanned': 'Account has been banned',
    
    // Success messages
    'success.saved': 'Saved successfully',
    'success.deleted': 'Deleted successfully',
    'success.updated': 'Updated successfully',
    'success.created': 'Created successfully',
    'success.passwordChanged': 'Password changed successfully',
    
    // Tips
    'tips.dragImage': 'Drag and drop image here or click to upload',
    'tips.selectTags': 'Select or create tags',
    'tips.writeContent': 'Write your thoughts here...',
    'tips.preview': 'Preview mode',
    
    // Editor related
    'editor.h1': 'Heading 1',
    'editor.h2': 'Heading 2',
    'editor.h3': 'Heading 3',
    'editor.bold': 'Bold',
    'editor.italic': 'Italic',
    'editor.underline': 'Underline',
    'editor.image': 'Insert Image',
    'editor.bulletList': 'Bullet List',
    'editor.orderedList': 'Ordered List',
    'editor.codeBlock': 'Code Block',
    'editor.blockquote': 'Quote',
    'editor.aiWriting': 'AI Writing',
    'editor.aiWritingTip': 'AI will generate content based on the title',
    'editor.generating': 'Generating...',
    'editor.placeholder': 'Start writing here...',
    
    // Log messages
    'log.uploadingImage': 'Uploading content image',
    'log.uploadImageSuccess': 'Content image uploaded successfully',
    'log.uploadImageError': 'Failed to upload image',
    'log.uploadingCover': 'Uploading cover image',
    'log.uploadCoverSuccess': 'Cover image uploaded successfully',
    'log.uploadCoverError': 'Failed to upload cover image',
    'log.generateTagsError': 'Failed to generate tags',
    'log.generateArticleError': 'Failed to generate article',
    'log.publishingArticle': 'Publishing article',
    'log.publishError': 'Failed to publish article',
    'log.checkUsernameError': 'Failed to check username',
    
    // Time related
    'time.justNow': 'Just now',
    'time.secondsAgo': '{seconds} seconds ago',
    'time.minutesAgo': '{minutes} minutes ago',
    'time.hoursAgo': '{hours} hours ago',
    'time.daysAgo': '{days} days ago',
    
    // Comments
    'comment.inputArea': 'Comment input area',
    'comment.loginToComment': 'Please login to comment',
    'comment.please': 'Please',
    'comment.toComment': 'to comment',
    'comment.replyToLogin': 'Please login to reply',
    'comment.placeholder': 'Write something here...',
    'comment.markdownSupport': 'Supports',
    'comment.gfmLink': 'GFM',
    'comment.preview': 'Preview comment',
    'comment.closePreview': 'Close preview',
    'comment.sending': 'Sending...',
    'comment.send': 'Send comment',
    'comment.noComments': 'No comments yet. Be the first to comment!',
    'comment.replyTo': 'Reply to {username}',
    'comment.writeReply': 'Write your reply...',
    'comment.justNow': 'Just now',
    'comment.hideComment': 'Hide comment',
    'comment.showComment': 'Show comment',
    'comment.hideReply': 'Hide reply',
    'comment.showReply': 'Show reply',
    'comment.delete': 'Delete comment',
    'comment.deleteReply': 'Delete reply',
    'comment.sendFailed': 'Failed to send comment',
    'comment.replyFailed': 'Failed to send reply',
    'comment.deleteFailed': 'Failed to delete comment',
    
    // User card
    'userCard.close': 'Close',
    'userCard.noArticles': 'No articles yet',
    'userCard.views': 'Views',
    'userCard.userCard': '{name}\'s Profile Card',
    'userCard.loading': 'Loading user data...',
    'userCard.loadError': 'Failed to load user data',
    
    // Account modal
    'account.profile': 'Profile',
    'account.articles': 'My Articles',
    'account.comments': 'My Comments',
    'account.security': 'Security',
    'account.danger': 'Danger Zone',
    'account.back': 'Back',
    'account.unknownUser': 'Unknown User',
    'account.realName': 'Real Name',
    'account.save': 'Save Changes',
    'account.defaultAvatar': 'User Avatar',
    'account.uploadAvatar': 'Upload New Avatar',
    'account.changeAvatar': 'Change Avatar',
    'account.uploadFailed': 'Upload Failed',
    'account.updateSuccess': 'Update Successful',
    'account.updateFailed': 'Update Failed',
    'account.username': 'Username',
    'account.dateOfBirth': 'Date of Birth',
    'account.bio': 'Bio',
    'account.bioPlaceholder': 'Write something about yourself...',
    'account.online': 'Online',
    'account.offline': 'Offline',
    'account.lastSeen': 'Last Seen',
    'account.joinedDate': 'Joined',
    'account.editField': 'Edit {field}',
    'account.deleteAccount': 'Delete Account',
    'account.deleteConfirm': 'Are you sure you want to delete your account? This action cannot be undone',
    'account.passwordRequired': 'Please enter your password to confirm',
    'account.deleteSuccess': 'Account deleted',
    'account.deleteFailed': 'Failed to delete account',
    'account.logout': 'Logout',
    'account.closeDialog': 'Close dialog',
    'account.currentPassword': 'Current Password',
    'account.newPassword': 'New Password',
    'account.confirmPassword': 'Confirm Password',
    'account.changePassword': 'Change Password',
    'account.changing': 'Changing...',
    'account.noArticles': 'No articles published yet',
    'account.writeArticle': 'Write an article',
    'account.readCount': '{count} reads',
    'account.commentCount': '{count} comments',
    'account.editArticle': 'Edit article',
    'account.deleteArticle': 'Delete article',
    'account.confirmDelete': 'Confirm delete',
    'account.cancelDelete': 'Cancel delete',
    'account.noComments': 'No comments yet',
    'account.commentOn': 'Commented on: {title}',
    'account.hideComment': 'Hide comment',
    'account.showComment': 'Show comment',
    'account.deleteComment': 'Delete comment',
    'account.dangerZoneDesc': 'After deleting your account, all your data will be permanently deleted and cannot be recovered. Please proceed with caution.',
    'account.deleteArticlesConfirm': 'Also delete all my articles',
    'account.deleteCommentsConfirm': 'Also delete all my comments',
    'account.deleting': 'Deleting...',
    'account.noAccount': 'Don\'t have an account?',
    'account.hasAccount': 'Already have an account?',
    'account.avatar': 'Avatar',
    'account.avatarTip': 'Square images recommended, PNG/JPG format, max 2MB',
    'account.password': 'Password',
    'account.enterPassword': 'Enter your password to confirm',
    'account.deleteAllWarning': 'Warning: Deleting your account will permanently delete all your articles and comments.',
    
    // Friend card
    'friendCard.articles': 'Articles',
    'friendCard.comments': 'Comments',
    'friendCard.userCard': '{name}\'s Profile Card',
    'friendCard.extractColorError': 'Failed to extract avatar color',
    
    // Search related
    'search.placeholder': 'Search articles...',
    'search.noResults': 'No articles found',
    'search.loading': 'Searching...',
    'search.error': 'Search failed',
    'search.enterKeyword': 'Enter keywords to search',
    'community.title': 'Community Members',
    'community.description': 'Meet interesting people, discover amazing stories',
    'community.noMembers': 'No members yet',
    
    // Account settings
    'account.settings': 'Settings',
    'account.generalSettings': 'General Settings',
    'account.language': 'Language',
    'account.currentLanguage': 'Current Language',
    'account.switchLanguage': 'Switch Language',
  }
};

// Create translation function
export const t = derived(locale, $locale => (key, params = {}) => {
  let text = translations[$locale][key];
  
  if (!text) {
    console.warn(`Missing translation for key: ${key} in locale: ${$locale}`);
    return key;
  }
  
  // Replace parameters
  Object.keys(params).forEach(param => {
    text = text.replace(`{${param}}`, params[param]);
  });
  
  return text;
});

// Toggle language
export function toggleLocale() {
  locale.update($locale => $locale === 'zh' ? 'en' : 'zh');
} 